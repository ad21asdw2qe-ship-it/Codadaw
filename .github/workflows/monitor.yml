name: SA-MP Monitor
on:
  schedule:
    - cron: '*/5 * * * *'
  workflow_dispatch:

jobs:
  monitor:
    runs-on: ubuntu-latest
    steps:
      - name: Check server online
        run: |
          python3 -c "
          import socket, struct
          try:
              sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
              sock.settimeout(5)
              packet = b'SAMP' + bytes([193,23,220,249]) + struct.pack('<H', 1171) + b'i'
              sock.sendto(packet, ('193.23.220.249', 1171))
              response, addr = sock.recvfrom(4096)
              if response[10] == 105:
                  players = struct.unpack('<H', response[12:14])[0]
                  print(f'ðŸŸ¢ ÐžÐ½Ð»Ð°Ð¹Ð½: {players} Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²')
              else:
                  print('âŒ ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚')
          except Exception as e:
              print(f'âŒ ÐžÑˆÐ¸Ð±ÐºÐ°: {e}')
          "
